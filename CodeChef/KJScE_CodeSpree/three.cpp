#include <bits/stdc++.h>

using namespace std;

#define all(c) c.begin(), c.end()
#define ll long long
#define for_set(c, it) \
 for(typeof(c.begin()) it = c.begin(); it != c.end(); it++)
#define MOD 1000000007

typedef vector<int> vi;
typedef vector<vi> vvi;
typedef pair<int, int> pi;

inline void display_vi(vi a,string s)
{
    for(int i = 0; i < a.size(); i++)
        cout<<a[i]<<s;
    cout<<endl;
}

/*
    Code Here!
*/

ll fibos[] = {1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, 2584, 4181, 6765, 10946, 17711, 28657, 46368, 75025, 121393, 196418, 317811, 514229, 832040, 1346269, 2178309, 3524578, 5702887, 9227465, 14930352, 24157817, 39088169, 63245986, 102334155, 165580141, 267914296, 433494437, 701408733, 1134903170, 836311896, 971215059, 1807526955, 1778742007, 1586268948, 1365010941, 951279875, 1316290809, 1267570677, 583861472, 851432142, 1435293614, 1286725749, 722019349, 1008745091, 730764433, 739509517, 1470273950, 1209783460, 680057396, 889840849, 1569898245, 1459739087, 1029637318, 489376391, 519013702, 1008390093, 527403788, 535793874, 1063197662, 598991529, 662189184, 1261180713, 923369890, 1184550596, 1107920479, 292471061, 400391533, 692862594, 1093254127, 786116714, 879370834, 1665487548, 1544858375, 1210345909, 755204270, 965550172, 1720754442, 1686304607, 1407059035, 1093363628, 500422649, 593786270, 1094208919, 687995182, 782204094, 1470199276, 1252403363, 722602625, 975005981, 1697608606, 1672614580, 1370223172, 1042837738, 413060896, 455898627, 868959523, 1324858150, 1193817666, 518675802, 712493461, 1231169263, 943662717, 1174831973, 1118494683, 293326642, 411821318, 705147960, 1116969278, 822117231, 939086502, 1761203733, 1700290228, 1461493947, 1161784161, 623278094, 785062248, 1408340342, 1193402583, 601742911, 795145487, 1396888398, 1192033878, 588922262, 780956133, 1369878395, 1150834521, 520712902, 671547416, 1192260318, 863807727, 1056068038, 919875758, 975943789, 1895819547, 1871763329, 1767582862, 1639346177, 1406929025, 1046275188, 453204199, 499479380, 952683579, 1452162959, 1404846531, 857009476, 1261856000, 1118865469, 380721455, 499586917, 880308372, 1379895289, 1260203654, 640098929, 900302576, 1540401505, 1440704074, 981105565, 1421809632, 1402915190, 824724808, 1227639991, 1052364792, 280004769, 332369554, 612374323, 944743877, 1557118200, 1501862070, 1058980256, 560842312, 619822561, 1180664873, 800487427, 981152293, 1781639720, 1762792006, 1544431712, 1307223704, 851655402, 1158879099, 1010534494, 169413579, 179948066, 349361645, 529309711, 878671356};

int main()
{
    std::ios::sync_with_stdio(false);
    int n;
    cin>>n;

    vector < pair<ll, ll> > a;
    vector<ll> b;
    
    for(int i = 0; i < n; i++)
    {
        ll no1, no2;
        cin>>no1>>no2;
        a.push_back(make_pair(no1, no2));
        if(abs(no1 - no2) == 1)
            b.push_back(1);
        else
        {
            ll val = __gcd(no1, no2);
            b.push_back(fibos[val - 1]);        
        }        
    }

    int t;
    cin>>t;

    while(t--)
    {
        int x;
        cin>>x;

        if(x)
        {
            int l, r;
            cin>>l>>r;
            l--;
            r--;
            ll max_val = b[l];
            for (int i = l + 1; i < r + 1; ++i)
            {
                max_val = max(max_val, b[i]);
            }
            cout<<max_val<<" ";
        }
        else
        {
            ll pos, no1, no2;
            cin>>pos>>no1>>no2;

            a[pos - 1].first = no1;
            a[pos - 1].second = no2;

            if(abs(no1 - no2) == 1)
                b[pos - 1] = 1;     
            else
            {
                ll val = __gcd(no1, no2);
                b[pos - 1] = fibos[val - 1];        
            }        
        }
    }
    cout<<endl;
    return 0;
}

